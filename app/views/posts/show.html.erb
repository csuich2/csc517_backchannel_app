<p id="notice"><%= notice %></p>

<p>
  <b>Title:</b>
  <%= @post.title %>
</p>

<p>
  <b>Text:</b>
  <%= @post.text %>
</p>

<p>
  <b>Poster:</b>
  <%= User.find(@post.owner_id).username %>
</p>

<p>
  <%= form_for([@post, @post.post_votes.build]) do |f| %>
    <div class="actions">
      <%= f.submit %>
    </div>
  <% end %>
</p>

<p>
  <b>Add Comment:</b>
  <%= form_for([@post, @post.comments.build]) do |f| %>
    <div class="field">
      <%= f.label :text %><br />
      <%= f.text_area :text, :rows => 3 %>
    </div>
    <div class="actions">
      <%= f.submit %>
    </div>
  <% end %>
</p>

<p>
  <b>Comments:</b>
  <% Comment.where(["post_id = ?", @post.id]).each do |c| %>
    <% if c.owner_id == @current_user.id %>
          <%= form_for([@post, c]) do |f| %>
            <div class="field">
              <%= f.label :text %><br />
              <%= f.text_area :text, :rows => 3 %>
            </div>
            <div class="actions">
              <%= f.submit %>
            </div>
            <%= link_to 'Delete', post_comment_path(@post, c), :confirm => 'Are you sure?', :method => :delete %>
        <% end %>
    <% else %>
        <p><%= c.text %> (<%= User.find(c.owner_id).username %>)</p>
    <% end %>
  <% end %>
</p>


<%= link_to 'Edit', edit_post_path(@post) %> |
<%= link_to 'Back', posts_path %>
